// Generated by Haxe 4.0.1
(function ($global) { "use strict";
function $extend(from, fields) {
	var proto = Object.create(from);
	for (var name in fields) proto[name] = fields[name];
	if( fields.toString !== Object.prototype.toString ) proto.toString = fields.toString;
	return proto;
}
var BB = function() { };
BB.__name__ = true;
BB.SquareDistance = function(s1,s2) {
	return BB.squareDistance[s1][s2];
};
BB.FileDistance = function(s1,s2) {
	return util_MathUtil.abs(Types.File_Of(s1) - Types.File_Of(s2));
};
BB.RankDistance = function(s1,s2) {
	return util_MathUtil.abs(Types.Rank_Of(s1) - Types.Rank_Of(s2));
};
BB.Init = function() {
	haxe_Log.trace("Init::BB",{ fileName : "BB.hx", lineNumber : 55, className : "BB", methodName : "Init"});
	if(BB.initialized) {
		return;
	}
	BB.filesBB = [];
	BB.ranksBB = [];
	var _g = 0;
	while(_g < 9) {
		var i = _g++;
		BB.filesBB.push(new Bitboard(511,0,0));
		BB.filesBB[i].ShiftL(9 * i);
		BB.ranksBB.push(new Bitboard(262657,262657,262657));
		BB.ranksBB[i].ShiftL(i);
	}
	BB.enemyField1[1] = BB.ranksBB[8].newCOPY();
	BB.enemyField1[0] = BB.ranksBB[0].newCOPY();
	BB.enemyField2[1] = BB.ranksBB[8].newOR(BB.ranksBB[7]);
	BB.enemyField2[0] = BB.ranksBB[0].newOR(BB.ranksBB[1]);
	BB.enemyField3[1] = BB.enemyField2[1].newOR(BB.ranksBB[6]);
	BB.enemyField3[0] = BB.enemyField2[0].newOR(BB.ranksBB[2]);
	BB.pawnLineBB[0] = new Bitboard();
	BB.pawnLineBB[1] = new Bitboard();
	var _g1 = 0;
	while(_g1 < 81) {
		var sq = _g1++;
		BB.squareBB[sq] = new Bitboard();
		BB.squareBB[sq].SetBit(sq);
	}
	var _g2 = 0;
	while(_g2 < 81) {
		var s1 = _g2++;
		BB.squareDistance[s1] = [];
		var _g21 = 0;
		while(_g21 < 81) {
			var s2 = _g21++;
			BB.squareDistance[s1][s2] = util_MathUtil.max(BB.FileDistance(s1,s2),BB.RankDistance(s1,s2));
		}
	}
	var this1 = 0;
	var pt = this1;
	var _g3 = 0;
	var _g4 = 31;
	while(_g3 < _g4) {
		var p = _g3++;
		var this2 = p;
		pt = this2;
		BB.stepAttacksBB[pt] = [];
		var _g31 = 0;
		while(_g31 < 81) {
			var s11 = _g31++;
			BB.stepAttacksBB[pt][s11] = new Bitboard();
		}
	}
	var s = 0;
	var _g5 = 0;
	var _g6 = 15;
	while(_g5 < _g6) {
		var pt1 = _g5++;
		BB.pseudoAttacks[pt1] = [];
	}
	var _g7 = 0;
	while(_g7 < 81) {
		var s3 = _g7++;
		var a = BB.AttacksBB(s3,new Bitboard(),5);
		BB.pseudoAttacks[5][s3] = BB.AttacksBB(s3,new Bitboard(),5);
		BB.pseudoAttacks[6][s3] = BB.AttacksBB(s3,new Bitboard(),6);
		BB.pseudoAttacks[13][s3] = BB.AttacksBB(s3,new Bitboard(),13);
		BB.pseudoAttacks[14][s3] = BB.AttacksBB(s3,new Bitboard(),14);
		BB.pseudoQueenAttacks[s3] = new Bitboard();
		BB.pseudoQueenAttacks[s3].OR(BB.pseudoAttacks[5][s3]);
		BB.pseudoQueenAttacks[s3].OR(BB.pseudoAttacks[6][s3]);
	}
	var _g8 = 0;
	while(_g8 < 81) {
		var s12 = _g8++;
		BB.betweenBB[s12] = [];
		BB.lineBB[s12] = [];
		var _g81 = 0;
		while(_g81 < 81) {
			var s21 = _g81++;
			BB.betweenBB[s12][s21] = new Bitboard();
			BB.lineBB[s12][s21] = new Bitboard();
			if(BB.pseudoQueenAttacks[s12].newAND(BB.squareBB[s21]).IsNonZero()) {
				var deltta = (s21 - s12) / BB.SquareDistance(s12,s21) | 0;
				s = s12 + deltta;
				while(s != s21) {
					BB.betweenBB[s12][s21].OR(BB.squareBB[s]);
					s += deltta;
				}
				pt = 6;
				if(BB.pseudoAttacks[5][s12].newAND(BB.squareBB[s21]).IsNonZero()) {
					pt = 5;
				}
				BB.lineBB[s12][s21].Copy(BB.pseudoAttacks[pt][s12]);
				BB.lineBB[s12][s21].AND(BB.pseudoAttacks[pt][s21]);
				BB.lineBB[s12][s21].OR(BB.squareBB[s12]);
				BB.lineBB[s12][s21].OR(BB.squareBB[s21]);
			}
		}
	}
	var c = 0;
	var _g9 = 1;
	var _g10 = 14;
	while(_g9 < _g10) {
		var p1 = _g9++;
		var this3 = p1;
		pt = this3;
		var _g91 = 0;
		while(_g91 < 81) {
			var s4 = _g91++;
			var _g92 = 0;
			while(_g92 < 9) {
				var k = _g92++;
				if(BB.steps[pt][k] == 0) {
					continue;
				}
				var to = s4;
				if(c == 0) {
					to += BB.steps[pt][k];
				} else {
					to -= BB.steps[pt][k];
				}
				if(Types.Is_SqOK(to) == false) {
					continue;
				}
				var tmp;
				if(BB.SquareDistance(s4,to) >= 3) {
					var this4 = Types.RawTypeOf(pt);
					tmp = this4 != 2;
				} else {
					tmp = false;
				}
				if(tmp) {
					continue;
				}
				BB.stepAttacksBB[Types.Make_Piece(c,pt)][s4].OR(BB.squareBB[to]);
			}
		}
	}
	var c1 = 1;
	var _g11 = 1;
	var _g12 = 14;
	while(_g11 < _g12) {
		var p2 = _g11++;
		var this5 = p2;
		pt = this5;
		var _g111 = 0;
		while(_g111 < 81) {
			var s5 = _g111++;
			var _g112 = 0;
			while(_g112 < 9) {
				var k1 = _g112++;
				if(BB.steps[pt][k1] == 0) {
					continue;
				}
				var to1 = s5;
				if(c1 == 0) {
					to1 += BB.steps[pt][k1];
				} else {
					to1 -= BB.steps[pt][k1];
				}
				if(Types.Is_SqOK(to1) == false) {
					continue;
				}
				var tmp1;
				if(BB.SquareDistance(s5,to1) >= 3) {
					var this6 = Types.RawTypeOf(pt);
					tmp1 = this6 != 2;
				} else {
					tmp1 = false;
				}
				if(tmp1) {
					continue;
				}
				BB.stepAttacksBB[Types.Make_Piece(c1,pt)][s5].OR(BB.squareBB[to1]);
			}
		}
	}
	BB.initialized = true;
};
BB.getStepAttacksBB = function(pc,sq) {
	return BB.stepAttacksBB[pc][sq];
};
BB.AttacksBB = function(sq,occ,pt) {
	switch(pt) {
	case 2:
		return BB.SlidingAttack(BB.rDeltas,sq,occ);
	case 5:
		return BB.SlidingAttack(BB.bDeltas,sq,occ);
	case 6:
		return BB.SlidingAttack(BB.rDeltas,sq,occ);
	case 13:
		return BB.SlidingGoldenAttack(BB.bDeltas,sq,occ);
	case 14:
		return BB.SlidingGoldenAttack(BB.rDeltas,sq,occ);
	default:
		return new Bitboard();
	}
};
BB.SlidingAttack = function(deltas,sq,occ) {
	var attack = new Bitboard();
	var _g = 0;
	while(_g < 4) {
		var i = _g++;
		if(deltas[i] == 0) {
			return attack;
		}
		var s = sq + deltas[i];
		while(Types.Is_SqOK(s) && BB.SquareDistance(s,s - deltas[i]) == 1) {
			attack.OR(BB.squareBB[s]);
			if(occ.newAND(BB.squareBB[s]).IsNonZero()) {
				break;
			}
			s += deltas[i];
		}
	}
	return attack;
};
BB.SlidingGoldenAttack = function(deltas,sq,occ) {
	var attack = BB.stepAttacksBB[8][sq].newCOPY();
	var _g = 0;
	while(_g < 4) {
		var i = _g++;
		if(deltas[i] == 0) {
			return attack;
		}
		var s = sq + deltas[i];
		while(Types.Is_SqOK(s) && BB.SquareDistance(s,s - deltas[i]) == 1) {
			attack.OR(BB.squareBB[s]);
			if(occ.newAND(BB.squareBB[s]).IsNonZero()) {
				break;
			}
			s += deltas[i];
		}
	}
	return attack;
};
BB.ShiftBB = function(b,deltta) {
	if(deltta == -1) {
		return b.newShiftR(1);
	}
	if(deltta == 1) {
		return b.newShiftL(1);
	}
	if(deltta == -10) {
		return b.newAND(BB.filesBB[8].newNOT()).newShiftL(10);
	}
	if(deltta == -8) {
		return b.newAND(BB.filesBB[8].newNOT()).newShiftR(8);
	}
	if(deltta == 8) {
		return b.newAND(BB.filesBB[0].newNOT()).newShiftL(8);
	}
	if(deltta == 10) {
		return b.newAND(BB.filesBB[0].newNOT()).newShiftR(10);
	}
	var zero = new Bitboard();
	return zero;
};
var Bitboard = function(l,m,u) {
	if(u == null) {
		u = 0;
	}
	if(m == null) {
		m = 0;
	}
	if(l == null) {
		l = 0;
	}
	this.needCount = false;
	this.count = 0;
	this.upper = 0;
	this.middle = 0;
	this.lower = 0;
	this.lower = l;
	this.middle = m;
	this.upper = u;
};
Bitboard.__name__ = true;
Bitboard.LeastSB = function(theInt) {
	var i = -1;
	if((theInt & 65535) == 0) {
		i += 16;
		theInt >>>= 16;
	}
	if((theInt & 255) == 0) {
		i += 8;
		theInt >>>= 8;
	}
	if((theInt & 15) == 0) {
		i += 4;
		theInt >>>= 4;
	}
	if((theInt & 3) == 0) {
		i += 2;
		theInt >>>= 2;
	}
	if((theInt & 1) == 0) {
		++i;
		theInt >>>= 1;
	}
	if((theInt & 1) != 0) {
		++i;
	}
	return i;
};
Bitboard.prototype = {
	Clear: function() {
		this.lower = 0;
		this.middle = 0;
		this.upper = 0;
		this.count = 0;
		this.needCount = false;
	}
	,Copy: function(other) {
		this.lower = other.lower;
		this.middle = other.middle;
		this.upper = other.upper;
		this.count = other.count;
		this.needCount = other.needCount;
	}
	,newCOPY: function() {
		var newBB = new Bitboard();
		newBB.Copy(this);
		return newBB;
	}
	,IsZero: function() {
		if(this.lower == 0 && this.middle == 0) {
			return this.upper == 0;
		} else {
			return false;
		}
	}
	,IsNonZero: function() {
		if(!(this.lower != 0 || this.middle != 0)) {
			return this.upper != 0;
		} else {
			return true;
		}
	}
	,isSet: function(sq) {
		if(sq < 27) {
			return (this.lower & 1 << sq) != 0;
		} else if(sq < 54) {
			return (this.middle & 1 << sq - 27) != 0;
		} else {
			return (this.upper & 1 << sq - 54) != 0;
		}
	}
	,LSB: function() {
		if(this.lower != 0) {
			return Bitboard.LeastSB(this.lower);
		}
		if(this.middle != 0) {
			return Bitboard.LeastSB(this.middle) + 27;
		}
		if(this.upper != 0) {
			return Bitboard.LeastSB(this.upper) + 54;
		}
		return -1;
	}
	,OR: function(other) {
		this.lower |= other.lower;
		this.middle |= other.middle;
		this.upper |= other.upper;
		this.needCount = true;
	}
	,newOR: function(other) {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.OR(other);
		return newBB;
	}
	,XOR: function(other) {
		this.lower ^= other.lower;
		this.middle ^= other.middle;
		this.upper ^= other.upper;
		this.needCount = true;
	}
	,newXOR: function(other) {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.XOR(other);
		return newBB;
	}
	,PopLSB: function() {
		var index = -1;
		if(this.lower != 0) {
			this.count--;
			index = Bitboard.LeastSB(this.lower);
			this.lower &= this.lower - 1;
			return index;
		}
		if(this.middle != 0) {
			this.count--;
			index = 27 + Bitboard.LeastSB(this.middle);
			this.middle &= this.middle - 1;
			return index;
		}
		if(this.upper != 0) {
			this.count--;
			index = 54 + Bitboard.LeastSB(this.upper);
			this.upper &= this.upper - 1;
			return index;
		}
		return -1;
	}
	,ShiftL: function(theShift) {
		if(theShift < 27) {
			this.upper <<= theShift;
			this.upper |= this.middle >>> 27 - theShift;
			this.middle <<= theShift;
			this.middle |= this.lower >>> 27 - theShift;
			this.lower <<= theShift;
		} else if(theShift < 54) {
			this.upper = this.middle >>> theShift - 27;
			this.upper |= this.lower >>> 54 - theShift;
			this.middle = this.lower << theShift - 27;
			this.lower = 0;
		} else {
			this.upper = this.lower << theShift - 54;
			this.lower = 0;
		}
		this.needCount = true;
	}
	,newShiftL: function(theShift) {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.ShiftL(theShift);
		return newBB;
	}
	,ShiftR: function(theShift) {
		if(theShift < 27) {
			this.lower >>>= theShift;
			this.lower |= this.middle << 27 - theShift >>> 27 - theShift << 27 - theShift;
			this.middle >>>= theShift;
			this.middle |= this.upper << 27 - theShift >>> 27 - theShift << 27 - theShift;
			this.upper >>>= theShift;
		} else if(theShift < 54) {
			this.lower = this.middle >>> theShift - 27;
			this.lower |= this.upper << 27 - theShift >>> 27 - theShift << 27 - theShift;
			this.middle = this.upper >>> theShift - 27;
			this.upper = 0;
		} else {
			this.lower = this.upper >>> theShift - 54;
			this.middle = 0;
			this.upper = 0;
		}
		this.needCount = true;
	}
	,newShiftR: function(theShift) {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.ShiftR(theShift);
		return newBB;
	}
	,SetBit: function(theIndex) {
		if(theIndex < 27) {
			this.lower |= 1 << theIndex;
		} else if(theIndex < 54) {
			this.middle |= 1 << theIndex - 27;
		} else {
			this.upper |= 1 << theIndex - 54;
		}
		this.needCount = true;
	}
	,ClrBit: function(theIndex) {
		if(theIndex < 27) {
			this.lower ^= 1 << theIndex;
		} else if(theIndex < 54) {
			this.middle ^= 1 << theIndex - 27;
		} else {
			this.upper ^= 1 << theIndex - 54;
		}
		this.needCount = true;
	}
	,NORM27: function() {
		this.lower &= 134217727;
		this.middle &= 134217727;
		this.upper &= 134217727;
		this.needCount = true;
		return this;
	}
	,AND: function(other) {
		this.lower &= other.lower;
		this.middle &= other.middle;
		this.upper &= other.upper;
		this.needCount = true;
	}
	,newAND: function(other) {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.AND(other);
		return newBB;
	}
	,NOT: function() {
		this.lower = ~this.lower;
		this.middle = ~this.middle;
		this.upper = ~this.upper;
		this.count = 81 - this.count;
	}
	,newNOT: function() {
		var newBB = new Bitboard();
		newBB.Copy(this);
		newBB.NOT();
		return newBB;
	}
	,toStringBB: function() {
		var s = "";
		var _g = 0;
		while(_g < 81) {
			var i = _g++;
			var f = 8 - i % 9;
			var r = i / 9 | 0;
			var sq = f * 9 + r;
			if(i % 9 == 0) {
				s += "\n";
			}
			if(this.isSet(sq)) {
				s += "1";
			} else {
				s += "0";
			}
		}
		return s;
	}
};
var EReg = function(r,opt) {
	this.r = new RegExp(r,opt.split("u").join(""));
};
EReg.__name__ = true;
EReg.prototype = {
	match: function(s) {
		if(this.r.global) {
			this.r.lastIndex = 0;
		}
		this.r.m = this.r.exec(s);
		this.r.s = s;
		return this.r.m != null;
	}
};
var Engine = function() {
	haxe_Log.trace("Engine:new",{ fileName : "Engine.hx", lineNumber : 12, className : "Engine", methodName : "new"});
};
Engine.__name__ = true;
Engine.main = function() {
	haxe_Log.trace("Engine main",{ fileName : "Engine.hx", lineNumber : 16, className : "Engine", methodName : "main"});
	Engine.pos = new Position();
	Engine.Init();
	Engine.global.onmessage = Engine.onMessage;
};
Engine.Init = function() {
	BB.Init();
	Position.Init();
	Evaluate.Init();
	Search.Init();
};
Engine.onMessage = function(m) {
	var msg = m.data;
	var res = "";
	haxe_Log.trace("Endine get data = " + msg,{ fileName : "Engine.hx", lineNumber : 32, className : "Engine", methodName : "onMessage"});
	if(msg.indexOf("position ") == 0) {
		res = Engine.doThink(msg);
	}
	Engine.global.postMessage(res);
};
Engine.doThink = function(msg) {
	Engine.pos.setPosition(HxOverrides.substr(msg,9,null));
	Engine.pos.printBoard();
	haxe_Log.trace("Engine::doThink pos.c: " + Engine.pos.SideToMove(),{ fileName : "Engine.hx", lineNumber : 42, className : "Engine", methodName : "doThink"});
	Search.Reset(Engine.pos);
	Search.Think();
	var moveResult = Search.rootMoves[0].pv[0];
	var res = "bestmove " + Types.Move_To_String(moveResult);
	haxe_Log.trace(res,{ fileName : "Engine.hx", lineNumber : 47, className : "Engine", methodName : "doThink"});
	return res;
};
var Evaluate = function() { };
Evaluate.__name__ = true;
Evaluate.Init = function() {
};
Evaluate.material = function(pos) {
	var v = 0;
	var _g = 0;
	while(_g < 81) {
		var sq = _g++;
		v += Evaluate.pieceValue[pos.PieceOn(sq)];
	}
	var _g1 = 1;
	var _g2 = 8;
	while(_g1 < _g2) {
		var pr = _g1++;
		var this1 = pr;
		v += pos.HandCount(0,this1) * Evaluate.pieceValue[pr];
	}
	var _g11 = 1;
	var _g21 = 8;
	while(_g11 < _g21) {
		var pr1 = _g11++;
		var this2 = pr1;
		v += -1 * pos.HandCount(1,this2) * Evaluate.pieceValue[pr1];
	}
	return v;
};
Evaluate.DoEvaluate = function(pos,doTrace) {
	haxe_Log.trace("Evaluate::DoEvaluate v=" + pos.state().materialValue + " c=" + pos.SideToMove() + " c2=" + pos.sideToMove + " -v=" + -pos.state().materialValue,{ fileName : "Evaluate.hx", lineNumber : 99, className : "Evaluate", methodName : "DoEvaluate"});
	if(pos.SideToMove() == 0) {
		return pos.state().materialValue;
	} else {
		return -1 * pos.state().materialValue;
	}
};
var HxOverrides = function() { };
HxOverrides.__name__ = true;
HxOverrides.cca = function(s,index) {
	var x = s.charCodeAt(index);
	if(x != x) {
		return undefined;
	}
	return x;
};
HxOverrides.substr = function(s,pos,len) {
	if(len == null) {
		len = s.length;
	} else if(len < 0) {
		if(pos == 0) {
			len = s.length + len;
		} else {
			return "";
		}
	}
	return s.substr(pos,len);
};
Math.__name__ = true;
var MoveExt = function() {
	this.score = 0;
	this.move = 0;
};
MoveExt.__name__ = true;
var MoveList = function() {
	this.moveCount = 0;
	this.curIndex = 0;
	this.mlist = [];
	var _g = 0;
	while(_g < 600) {
		var i = _g++;
		this.mlist[i] = new MoveExt();
	}
};
MoveList.__name__ = true;
MoveList.prototype = {
	Reset: function() {
		this.curIndex = 0;
		this.moveCount = 0;
	}
	,SerializeBR: function(from,b,us) {
		if(BB.squareBB[from].newAND(BB.enemyField3[us]).IsNonZero()) {
			b.NORM27();
			while(b.IsNonZero()) {
				var tmp = b.PopLSB();
				this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,tmp);
				this.moveCount++;
			}
			return;
		}
		var pb = b.newAND(BB.enemyField3[us]);
		var nb = b.newAND(BB.enemyField3[us].newNOT());
		var to;
		pb.NORM27();
		while(pb.IsNonZero()) {
			to = pb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,to);
			this.moveCount++;
		}
		nb.NORM27();
		while(nb.IsNonZero()) {
			to = nb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(from,to);
			this.moveCount++;
		}
	}
	,SerializeS: function(from,b,us) {
		var pb1 = new Bitboard();
		var to;
		if(BB.squareBB[from].newAND(BB.enemyField3[us]).IsNonZero()) {
			pb1.Copy(b);
			pb1.NORM27();
			while(pb1.IsNonZero()) {
				to = pb1.PopLSB();
				this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,to);
				this.moveCount++;
			}
		}
		var pb2 = b.newAND(BB.enemyField3[us]);
		pb2.AND(pb1.newNOT());
		pb2.NORM27();
		while(pb2.IsNonZero()) {
			to = pb2.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,to);
			this.moveCount++;
		}
		b.NORM27();
		while(b.IsNonZero()) {
			to = b.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(from,to);
			this.moveCount++;
		}
	}
	,SerializeN: function(from,b,us) {
		var pb = b.newAND(BB.enemyField3[us]).NORM27();
		var nb = b.newAND(BB.enemyField2[us].newNOT()).NORM27();
		var to;
		while(pb.IsNonZero()) {
			to = pb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,to);
			this.moveCount++;
		}
		while(nb.IsNonZero()) {
			to = nb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(from,to);
			this.moveCount++;
		}
	}
	,SerializeL: function(from,b,us) {
		var pb = b.newAND(BB.enemyField3[us]).NORM27();
		var nb = b.newAND(BB.enemyField2[us].newNOT()).NORM27();
		var to;
		while(pb.IsNonZero()) {
			to = pb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move_Promote(from,to);
			this.moveCount++;
		}
		while(nb.IsNonZero()) {
			to = nb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(from,to);
			this.moveCount++;
		}
	}
	,SerializePawns: function(b,delta,us) {
		var pb = b.newAND(BB.enemyField3[us]).NORM27();
		var nb = b.newAND(BB.enemyField3[us].newNOT()).NORM27();
		var to = 0;
		while(pb.IsNonZero()) {
			to = pb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move_Promote(to - delta,to);
			this.moveCount++;
		}
		while(nb.IsNonZero()) {
			to = nb.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(to - delta,to);
			this.moveCount++;
		}
	}
	,SerializeDrop: function(pt,b) {
		var to;
		b.NORM27();
		while(b.IsNonZero()) {
			to = b.PopLSB();
			var tmp = Types.RawTypeOf(pt);
			this.mlist[this.moveCount].move = Types.Make_Move_Drop(tmp,to);
			this.moveCount++;
		}
	}
	,Serialize: function(from,b) {
		b.NORM27();
		while(b.IsNonZero()) {
			var tmp = b.PopLSB();
			this.mlist[this.moveCount].move = Types.Make_Move(from,tmp);
			this.moveCount++;
		}
	}
	,GenerateMoves: function(pos,us,target,pt) {
		var pl = pos.PiecesColourType(us,pt).NORM27();
		var from = 0;
		var pc = Types.Make_Piece(us,pt);
		while(pl.IsNonZero()) {
			from = pl.PopLSB();
			var b = pos.AttacksFromPTypeSQ(from,pc).newAND(target);
			if(pt == 5 || pt == 6) {
				this.SerializeBR(from,b,us);
			} else if(pt == 4) {
				this.SerializeS(from,b,us);
			} else if(pt == 3) {
				this.SerializeN(from,b,us);
			} else if(pt == 2) {
				this.SerializeL(from,b,us);
			} else {
				this.Serialize(from,b);
			}
		}
	}
	,GenerateKingMoves: function(pos,us,target) {
		this.GenerateMoves(pos,us,target,8);
	}
	,generatePawnMoves: function(pos,us,target) {
		var up = 1;
		var tRank8BB = BB.ranksBB[8];
		if(us == 0) {
			up = -1;
			tRank8BB = BB.ranksBB[0];
		}
		var emptySquares = target;
		var pawnsNotOn7 = pos.PiecesColourType(us,1).newAND(tRank8BB.newNOT());
		var b1 = BB.ShiftBB(pawnsNotOn7,up).newAND(emptySquares);
		this.SerializePawns(b1,up,us);
	}
	,GenerateDopMoves: function(pos,us,target,pt) {
		if(!pos.HandExists(us,Types.RawTypeOf(pt))) {
			return;
		}
		var target2 = target.newAND(pos.PiecesAll().newNOT());
		switch(pt) {
		case 1:
			target2.AND(BB.enemyField1[us].newNOT());
			target2.AND(BB.pawnLineBB[us].newNOT());
			break;
		case 2:
			target2.AND(BB.enemyField1[us].newNOT());
			break;
		case 3:
			target2.AND(BB.enemyField2[us].newNOT());
			break;
		default:
		}
		this.SerializeDrop(pt,target2);
	}
	,GenerateAllDopMoves: function(pos,us,target) {
		this.GenerateDopMoves(pos,us,target,1);
		this.GenerateDopMoves(pos,us,target,2);
		this.GenerateDopMoves(pos,us,target,3);
		this.GenerateDopMoves(pos,us,target,4);
		this.GenerateDopMoves(pos,us,target,5);
		this.GenerateDopMoves(pos,us,target,6);
		this.GenerateDopMoves(pos,us,target,7);
	}
	,GenerateAll: function(pos,us,target,genType) {
		if(genType != 0) {
			this.GenerateAllDopMoves(pos,us,target);
		}
		this.generatePawnMoves(pos,us,target);
		this.GenerateMoves(pos,us,target,2);
		this.GenerateMoves(pos,us,target,3);
		this.GenerateMoves(pos,us,target,4);
		this.GenerateMoves(pos,us,target,5);
		this.GenerateMoves(pos,us,target,6);
		this.GenerateMoves(pos,us,target,7);
		this.GenerateMoves(pos,us,target,9);
		this.GenerateMoves(pos,us,target,10);
		this.GenerateMoves(pos,us,target,11);
		this.GenerateMoves(pos,us,target,12);
		this.GenerateMoves(pos,us,target,13);
		this.GenerateMoves(pos,us,target,14);
		this.GenerateKingMoves(pos,us,target);
	}
	,Generate: function(pos,genType) {
		var us = pos.SideToMove();
		var this1 = 0;
		var pt = this1;
		var this2 = 0;
		var pc = this2;
		if(genType == 4) {
			var target = pos.PiecesColour(us).newNOT();
			this.GenerateAll(pos,us,target,genType);
		}
		if(genType == 3) {
			var checkersCnt = 0;
			var ksq = pos.KingSquare(us);
			var checksq = 0;
			var sliderAttacks = new Bitboard();
			var b = new Bitboard();
			b.Copy(pos.Checkers());
			while(true) {
				++checkersCnt;
				checksq = b.PopLSB();
				pc = pos.PieceOn(checksq);
				pt = Types.TypeOf_Piece(pc);
				if(pt == 5 || pt == 6 || pt == 13 || pt == 14 || pt == 2) {
					sliderAttacks.OR(BB.lineBB[checksq][ksq].newXOR(BB.squareBB[checksq]));
				}
				if(pt == 13 || pt == 14) {
					sliderAttacks.OR(BB.getStepAttacksBB(8,checksq));
				}
				if(!b.IsNonZero()) {
					break;
				}
			}
			b = new Bitboard();
			b.Copy(pos.AttacksFromPTypeSQ(ksq,8));
			b.AND(pos.PiecesColour(us).newNOT());
			b.AND(sliderAttacks.newNOT());
			this.Serialize(ksq,b);
			if(checkersCnt > 1) {
				return;
			}
			var target1 = BB.betweenBB[checksq][ksq].newCOPY();
			var target2 = target1.newOR(BB.squareBB[checksq]);
			this.generatePawnMoves(pos,us,target2);
			this.GenerateMoves(pos,us,target2,2);
			this.GenerateMoves(pos,us,target2,3);
			this.GenerateMoves(pos,us,target2,4);
			this.GenerateMoves(pos,us,target2,5);
			this.GenerateMoves(pos,us,target2,6);
			this.GenerateMoves(pos,us,target2,7);
			this.GenerateMoves(pos,us,target2,9);
			this.GenerateMoves(pos,us,target2,10);
			this.GenerateMoves(pos,us,target2,11);
			this.GenerateMoves(pos,us,target2,12);
			this.GenerateMoves(pos,us,target2,13);
			this.GenerateMoves(pos,us,target2,14);
			this.GenerateAllDopMoves(pos,us,target1);
		}
		if(genType == 5) {
			if(pos.Checkers().IsNonZero()) {
				this.Generate(pos,3);
			} else {
				this.Generate(pos,4);
			}
			var ksq1 = pos.KingSquare(pos.SideToMove());
			var i = 0;
			while(i < this.moveCount) if(Types.Move_FromSq(this.mlist[i].move) == ksq1 && pos.Legal(this.mlist[i].move) == false) {
				this.moveCount--;
				this.mlist[i].move = this.mlist[this.moveCount].move;
			} else {
				++i;
			}
		}
	}
};
var MovePicker = function() {
	this.generated = false;
	this.stage = 0;
	this.end = 0;
	this.cur = 0;
	this.moves = new MoveList();
};
MovePicker.__name__ = true;
MovePicker.prototype = {
	InitA: function(p) {
		this.pos = p;
		this.moves.Reset();
		this.cur = 0;
		this.end = 0;
		if(p.Checkers().IsNonZero()) {
			this.stage = 6;
		} else {
			this.stage = 0;
		}
		this.GenerateNext();
	}
	,GenerateNext: function() {
		this.cur = 0;
		this.moves.Generate(this.pos,5);
		this.end = this.moves.moveCount;
		this.stage++;
	}
	,NextMove: function() {
		if(this.moves.moveCount == 0) {
			return 0;
		}
		var move = this.moves.mlist[this.cur].move;
		this.cur++;
		return move;
	}
};
var PSQTable = function() { };
PSQTable.__name__ = true;
var Position = function() {
	this.materialValue = 0;
	this.pieceList = [];
	this.pieceCount = [];
	this.index = [];
	this.byColorBB = [];
	this.byTypeBB = [];
	this.hand = [];
	this.sideToMove = 0;
	this.board = [];
	this.InitBB();
};
Position.__name__ = true;
Position.Init = function() {
	Position.psq[0] = [];
	Position.psq[1] = [];
	var _g = 0;
	var _g1 = 15;
	while(_g < _g1) {
		var pt = _g++;
		Position.psq[0][pt] = [];
		Position.psq[1][pt] = [];
		var v = Position.pieceValue[pt];
		var _g2 = 0;
		while(_g2 < 81) {
			var s = _g2++;
			var sFlip = Types.FlipSquare(s);
			Position.psq[0][pt][s] = v + PSQTable.psqT[pt][s];
			Position.psq[1][pt][sFlip] = -(v + PSQTable.psqT[pt][s]);
		}
	}
};
Position.prototype = {
	InitBB: function() {
		this.byTypeBB = [];
		var _g = 0;
		var _g1 = 31;
		while(_g < _g1) {
			var i = _g++;
			this.byTypeBB.push(new Bitboard());
		}
		this.byColorBB = [];
		this.byColorBB.push(new Bitboard());
		this.pieceCount[0] = [];
		this.pieceList[0] = [];
		this.pieceCount[0][0] = 0;
		this.pieceList[0][0] = [];
		this.pieceCount[0][1] = 0;
		this.pieceList[0][1] = [];
		this.pieceCount[0][2] = 0;
		this.pieceList[0][2] = [];
		this.pieceCount[0][3] = 0;
		this.pieceList[0][3] = [];
		this.pieceCount[0][4] = 0;
		this.pieceList[0][4] = [];
		this.pieceCount[0][5] = 0;
		this.pieceList[0][5] = [];
		this.pieceCount[0][6] = 0;
		this.pieceList[0][6] = [];
		this.pieceCount[0][7] = 0;
		this.pieceList[0][7] = [];
		this.pieceCount[0][8] = 0;
		this.pieceList[0][8] = [];
		this.pieceCount[0][9] = 0;
		this.pieceList[0][9] = [];
		this.pieceCount[0][10] = 0;
		this.pieceList[0][10] = [];
		this.pieceCount[0][11] = 0;
		this.pieceList[0][11] = [];
		this.pieceCount[0][12] = 0;
		this.pieceList[0][12] = [];
		this.pieceCount[0][13] = 0;
		this.pieceList[0][13] = [];
		this.pieceCount[0][14] = 0;
		this.pieceList[0][14] = [];
		this.byColorBB.push(new Bitboard());
		this.pieceCount[1] = [];
		this.pieceList[1] = [];
		this.pieceCount[1][0] = 0;
		this.pieceList[1][0] = [];
		this.pieceCount[1][1] = 0;
		this.pieceList[1][1] = [];
		this.pieceCount[1][2] = 0;
		this.pieceList[1][2] = [];
		this.pieceCount[1][3] = 0;
		this.pieceList[1][3] = [];
		this.pieceCount[1][4] = 0;
		this.pieceList[1][4] = [];
		this.pieceCount[1][5] = 0;
		this.pieceList[1][5] = [];
		this.pieceCount[1][6] = 0;
		this.pieceList[1][6] = [];
		this.pieceCount[1][7] = 0;
		this.pieceList[1][7] = [];
		this.pieceCount[1][8] = 0;
		this.pieceList[1][8] = [];
		this.pieceCount[1][9] = 0;
		this.pieceList[1][9] = [];
		this.pieceCount[1][10] = 0;
		this.pieceList[1][10] = [];
		this.pieceCount[1][11] = 0;
		this.pieceList[1][11] = [];
		this.pieceCount[1][12] = 0;
		this.pieceList[1][12] = [];
		this.pieceCount[1][13] = 0;
		this.pieceList[1][13] = [];
		this.pieceCount[1][14] = 0;
		this.pieceList[1][14] = [];
		this.st = new StateInfo();
	}
	,AttacksFromPawn: function(sq,c) {
		return BB.stepAttacksBB[Types.Make_Piece(c,1)][sq];
	}
	,AttackersToSq: function(sq) {
		return this.AttackersTo(sq,this.byTypeBB[0]);
	}
	,Checkers: function() {
		return this.st.checkersBB;
	}
	,KingSquare: function(c) {
		return this.pieceList[c][8][0];
	}
	,Legal: function(m) {
		if(Types.Is_Drop(m)) {
			return true;
		}
		var us = this.sideToMove;
		var from = Types.Move_FromSq(m);
		if(Types.TypeOf_Piece(this.PieceOn(from)) == 8) {
			if(this.AttackersToSq(Types.Move_ToSq(m)).newAND(this.PiecesColour(Types.OppColour(us))).IsZero()) {
				return true;
			}
			return false;
		}
		return true;
	}
	,PiecesAll: function() {
		return this.byTypeBB[0];
	}
	,PiecesColour: function(c) {
		return this.byColorBB[c];
	}
	,PiecesColourType: function(c,pt) {
		return this.byColorBB[c].newAND(this.byTypeBB[pt]);
	}
	,PieceOn: function(sq) {
		var this1 = this.board[sq];
		return this1;
	}
	,PiecesType: function(pt) {
		return this.byTypeBB[pt];
	}
	,PiecesTypes: function(pt1,pt2) {
		return this.byTypeBB[pt1].newOR(this.byTypeBB[pt2]);
	}
	,changeSideToMove: function() {
		this.sideToMove = (this.sideToMove + 1) % 2;
	}
	,doMove: function(move,newSt) {
		this.doMoveFull(move,newSt);
	}
	,doMoveFull: function(move,newSt) {
		var from = Types.Move_FromSq(move);
		var to = Types.Move_ToSq(move);
		var us = this.sideToMove;
		var them = Types.OppColour(us);
		var pc = this.MovedPieceAfter(move);
		var pr = Types.RawTypeOf(pc);
		var pt = Types.TypeOf_Piece(pc);
		var materialDiff = 0;
		newSt.Copy(this.st);
		newSt.previous = this.st;
		this.st = newSt;
		if(Types.Is_Drop(move)) {
			this.SubHand(us,pr);
			this.PutPiece(to,us,pt);
			materialDiff = 0;
			this.changeSideToMove();
			return;
		}
		var captured = Types.TypeOf_Piece(this.PieceOn(to));
		var capturedRaw = Types.RawTypeOf(captured);
		if(captured != 0) {
			var capsq = to;
			this.AddHand(us,capturedRaw);
			this.RemovePiece(capsq,them,captured);
		}
		this.RemovePiece(from,us,pt);
		this.MovePiece(from,to,us,pt);
		if(Types.Move_Type(move) == 32768) {
			this.RemovePiece(to,us,pt);
			var this1 = pt + 8;
			this.PutPiece(to,us,this1);
			materialDiff = Evaluate.proDiffPieceValue[pt];
		}
		this.st.capturedType = captured;
		materialDiff += Evaluate.capturePieceValue[captured];
		this.st.materialValue = this.st.previous.materialValue + (us == 0 ? materialDiff : -materialDiff);
		this.changeSideToMove();
	}
	,undoMove: function(move) {
		this.changeSideToMove();
		var us = this.sideToMove;
		var them = Types.OppColour(us);
		var to = Types.Move_ToSq(move);
		var pc = this.MovedPieceAfter(move);
		var pr = Types.RawTypeOf(pc);
		var pt = Types.TypeOf_Piece(this.PieceOn(to));
		if(Types.Is_Drop(move)) {
			this.AddHand(us,pr);
			this.RemovePiece(to,us,pt);
		} else {
			var from = Types.Move_FromSq(move);
			var captured = this.st.capturedType;
			var capturedRaw = Types.RawTypeOf(captured);
			if(Types.Move_Type(move) == 32768) {
				var promotion = pt;
				var this1 = pt - 8;
				pt = this1;
				this.RemovePiece(to,us,promotion);
				this.PutPiece(to,us,pt);
			}
			this.MovePiece(to,from,us,pt);
			if(captured != 0) {
				var capsq = to;
				this.SubHand(us,capturedRaw);
				this.PutPiece(capsq,them,captured);
			}
		}
		this.st = this.st.previous;
	}
	,PutPiece: function(sq,c,pt) {
		this.board[sq] = Types.Make_Piece(c,pt);
		this.byColorBB[c].SetBit(sq);
		this.byTypeBB[0].SetBit(sq);
		this.byTypeBB[pt].SetBit(sq);
		var tmp = this.pieceCount[c];
		tmp[0]++;
		var tmp1 = this.pieceCount[c];
		this.index[sq] = tmp1[pt]++;
		this.pieceList[c][pt][this.index[sq]] = sq;
		if(pt == 1) {
			BB.pawnLineBB[c].OR(BB.filesBB[Types.File_Of(sq)]);
		}
	}
	,MovePiece: function(from,to,c,pt) {
		this.board[to] = Types.Make_Piece(c,pt);
		this.board[from] = 0;
		this.byColorBB[c].SetBit(to);
		this.byTypeBB[0].SetBit(to);
		this.byTypeBB[pt].SetBit(to);
		this.index[to] = this.index[from];
		this.pieceList[c][pt][this.index[to]] = to;
		if(pt == 1) {
			BB.pawnLineBB[c].OR(BB.filesBB[Types.File_Of(to)]);
		}
	}
	,RemovePiece: function(sq,c,pt) {
		this.board[sq] = 0;
		this.byColorBB[c].ClrBit(sq);
		this.byTypeBB[0].ClrBit(sq);
		this.byTypeBB[pt].ClrBit(sq);
		var tmp = this.pieceCount[c];
		tmp[0]--;
		var tmp1 = this.pieceCount[c];
		tmp1[pt]--;
		var lastSquare = this.pieceList[c][pt][this.pieceCount[c][pt]];
		this.index[lastSquare] = this.index[sq];
		this.pieceList[c][pt][this.index[lastSquare]] = lastSquare;
		this.pieceList[c][pt][this.pieceCount[c][pt]] = 81;
		if(pt == 1) {
			BB.pawnLineBB[c].AND(BB.filesBB[Types.File_Of(sq)].newNOT());
		}
	}
	,HandExists: function(c,pr) {
		return this.hand[c][pr] > 0;
	}
	,AddHand: function(c,pr,n) {
		if(n == null) {
			n = 1;
		}
		this.hand[c][pr] += n;
	}
	,SubHand: function(c,pr,n) {
		if(n == null) {
			n = 1;
		}
		this.hand[c][pr] -= n;
	}
	,HandCount: function(c,pr) {
		return this.hand[c][pr];
	}
	,AttackersTo: function(s,occ) {
		var attBB = this.AttacksFromPawn(s,0).newAND(this.PiecesColourType(1,1));
		attBB.OR(this.AttacksFromPawn(s,1).newAND(this.PiecesColourType(0,1)));
		attBB.OR(this.AttacksFromPTypeSQ(s,19).newAND(this.PiecesColourType(0,3)));
		attBB.OR(this.AttacksFromPTypeSQ(s,3).newAND(this.PiecesColourType(1,3)));
		attBB.OR(this.AttacksFromPTypeSQ(s,18).newAND(this.PiecesColourType(0,2)));
		attBB.OR(this.AttacksFromPTypeSQ(s,2).newAND(this.PiecesColourType(1,2)));
		attBB.OR(this.AttacksFromPTypeSQ(s,20).newAND(this.PiecesColourType(0,4)));
		attBB.OR(this.AttacksFromPTypeSQ(s,4).newAND(this.PiecesColourType(1,4)));
		attBB.OR(this.AttacksFromPTypeSQ(s,23).newAND(this.PiecesColourType(0,7)));
		attBB.OR(this.AttacksFromPTypeSQ(s,7).newAND(this.PiecesColourType(1,7)));
		attBB.OR(this.AttacksFromPTypeSQ(s,25).newAND(this.PiecesColourType(0,9)));
		attBB.OR(this.AttacksFromPTypeSQ(s,9).newAND(this.PiecesColourType(1,9)));
		attBB.OR(this.AttacksFromPTypeSQ(s,26).newAND(this.PiecesColourType(0,10)));
		attBB.OR(this.AttacksFromPTypeSQ(s,10).newAND(this.PiecesColourType(1,10)));
		attBB.OR(this.AttacksFromPTypeSQ(s,27).newAND(this.PiecesColourType(0,11)));
		attBB.OR(this.AttacksFromPTypeSQ(s,11).newAND(this.PiecesColourType(1,11)));
		attBB.OR(this.AttacksFromPTypeSQ(s,28).newAND(this.PiecesColourType(0,12)));
		attBB.OR(this.AttacksFromPTypeSQ(s,12).newAND(this.PiecesColourType(1,12)));
		attBB.OR(BB.AttacksBB(s,occ,6).newAND(this.PiecesTypes(6,14)));
		attBB.OR(BB.AttacksBB(s,occ,5).newAND(this.PiecesTypes(5,13)));
		attBB.OR(this.AttacksFromPTypeSQ(s,8).newAND(this.PiecesTypes(14,13)));
		attBB.OR(this.AttacksFromPTypeSQ(s,8).newAND(this.PiecesType(8)));
		return attBB;
	}
	,MovedPieceAfter: function(m) {
		if(Types.Is_Drop(m)) {
			var this1 = m >>> 7 & 127;
			return this1;
		} else {
			return this.PieceOn(Types.Move_FromSq(m));
		}
	}
	,setPosition: function(sfen) {
		this.InitBB();
		this.Clear();
		var sf = new SFEN(sfen);
		this.sideToMove = sf.SideToMove();
		this.board = sf.getBoard();
		var _g = 0;
		while(_g < 81) {
			var i = _g++;
			var pc = this.PieceOn(i);
			var pt = Types.TypeOf_Piece(pc);
			var c = Types.getPieceColor(pc);
			if(pc == 0) {
				continue;
			}
			this.PutPiece(i,c,pt);
		}
		this.hand = sf.getHand();
		this.st.materialValue = Evaluate.material(this);
		var moves = sf.getMoves();
		var _g1 = 0;
		var _g2 = moves.length;
		while(_g1 < _g2) {
			var i1 = _g1++;
			this.doMove(moves[i1],new StateInfo());
		}
		var tmp = this.AttackersToSq(this.KingSquare(this.sideToMove));
		var tmp1 = this.PiecesColour(Types.OppColour(this.sideToMove));
		this.st.checkersBB = tmp.newAND(tmp1);
	}
	,SideToMove: function() {
		return this.sideToMove;
	}
	,state: function() {
		return this.st;
	}
	,AttacksFromPTypeSQ: function(sq,pc) {
		var pt = Types.TypeOf_Piece(pc);
		if(pt == 5 || pt == 6 || pt == 13 || pt == 14) {
			return BB.AttacksBB(sq,this.PiecesAll(),pt);
		} else if(pt == 2) {
			var rb = BB.AttacksBB(sq,this.PiecesAll(),6);
			var b = BB.getStepAttacksBB(pc,sq).newAND(rb);
			return b;
		} else {
			return BB.getStepAttacksBB(pc,sq);
		}
	}
	,Clear: function() {
		var _g = 0;
		while(_g < 81) {
			var i = _g++;
			this.board[i] = 0;
			this.index[i] = 0;
		}
		this.byTypeBB[0].Clear();
		this.byTypeBB[1].Clear();
		this.byTypeBB[2].Clear();
		this.byTypeBB[3].Clear();
		this.byTypeBB[4].Clear();
		this.byTypeBB[5].Clear();
		this.byTypeBB[6].Clear();
		this.byTypeBB[7].Clear();
		this.byTypeBB[8].Clear();
		this.byTypeBB[9].Clear();
		this.byTypeBB[10].Clear();
		this.byTypeBB[11].Clear();
		this.byTypeBB[12].Clear();
		this.byTypeBB[13].Clear();
		this.byTypeBB[14].Clear();
		this.byColorBB[0].Clear();
		this.pieceCount[0] = [];
		var _g1 = 0;
		while(_g1 < 15) {
			var j = _g1++;
			this.pieceCount[0][j] = 0;
			this.pieceList[0][j][0] = 0;
			this.pieceList[0][j][1] = 0;
			this.pieceList[0][j][2] = 0;
			this.pieceList[0][j][3] = 0;
			this.pieceList[0][j][4] = 0;
			this.pieceList[0][j][5] = 0;
			this.pieceList[0][j][6] = 0;
			this.pieceList[0][j][7] = 0;
			this.pieceList[0][j][8] = 0;
			this.pieceList[0][j][9] = 0;
			this.pieceList[0][j][10] = 0;
			this.pieceList[0][j][11] = 0;
			this.pieceList[0][j][12] = 0;
			this.pieceList[0][j][13] = 0;
			this.pieceList[0][j][14] = 0;
			this.pieceList[0][j][15] = 0;
		}
		this.byColorBB[1].Clear();
		this.pieceCount[1] = [];
		var _g11 = 0;
		while(_g11 < 15) {
			var j1 = _g11++;
			this.pieceCount[1][j1] = 0;
			this.pieceList[1][j1][0] = 0;
			this.pieceList[1][j1][1] = 0;
			this.pieceList[1][j1][2] = 0;
			this.pieceList[1][j1][3] = 0;
			this.pieceList[1][j1][4] = 0;
			this.pieceList[1][j1][5] = 0;
			this.pieceList[1][j1][6] = 0;
			this.pieceList[1][j1][7] = 0;
			this.pieceList[1][j1][8] = 0;
			this.pieceList[1][j1][9] = 0;
			this.pieceList[1][j1][10] = 0;
			this.pieceList[1][j1][11] = 0;
			this.pieceList[1][j1][12] = 0;
			this.pieceList[1][j1][13] = 0;
			this.pieceList[1][j1][14] = 0;
			this.pieceList[1][j1][15] = 0;
		}
		var _g12 = 0;
		while(_g12 < 15) {
			var i1 = _g12++;
			var _g13 = 0;
			while(_g13 < 16) {
				var j2 = _g13++;
				this.pieceList[1][i1][j2] = 81;
				this.pieceList[0][i1][j2] = 81;
			}
		}
	}
	,printBoard: function() {
		var s = "";
		s += "\n";
		var f = 8;
		while(f >= 0) {
			var sq = Types.Square(f,0);
			s += HxOverrides.substr("  " + this.board[sq],-3,null);
			--f;
		}
		s += "\n";
		var f1 = 8;
		while(f1 >= 0) {
			var sq1 = Types.Square(f1,1);
			s += HxOverrides.substr("  " + this.board[sq1],-3,null);
			--f1;
		}
		s += "\n";
		var f2 = 8;
		while(f2 >= 0) {
			var sq2 = Types.Square(f2,2);
			s += HxOverrides.substr("  " + this.board[sq2],-3,null);
			--f2;
		}
		s += "\n";
		var f3 = 8;
		while(f3 >= 0) {
			var sq3 = Types.Square(f3,3);
			s += HxOverrides.substr("  " + this.board[sq3],-3,null);
			--f3;
		}
		s += "\n";
		var f4 = 8;
		while(f4 >= 0) {
			var sq4 = Types.Square(f4,4);
			s += HxOverrides.substr("  " + this.board[sq4],-3,null);
			--f4;
		}
		s += "\n";
		var f5 = 8;
		while(f5 >= 0) {
			var sq5 = Types.Square(f5,5);
			s += HxOverrides.substr("  " + this.board[sq5],-3,null);
			--f5;
		}
		s += "\n";
		var f6 = 8;
		while(f6 >= 0) {
			var sq6 = Types.Square(f6,6);
			s += HxOverrides.substr("  " + this.board[sq6],-3,null);
			--f6;
		}
		s += "\n";
		var f7 = 8;
		while(f7 >= 0) {
			var sq7 = Types.Square(f7,7);
			s += HxOverrides.substr("  " + this.board[sq7],-3,null);
			--f7;
		}
		s += "\n";
		var f8 = 8;
		while(f8 >= 0) {
			var sq8 = Types.Square(f8,8);
			s += HxOverrides.substr("  " + this.board[sq8],-3,null);
			--f8;
		}
		haxe_Log.trace(s,{ fileName : "Position.hx", lineNumber : 379, className : "Position", methodName : "printBoard"});
	}
};
var SFEN = function(sfen) {
	this.moves = [];
	this.hand = [[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]];
	this.sideToMove = 0;
	this.board = [];
	this.setPosition(sfen);
};
SFEN.__name__ = true;
SFEN.prototype = {
	getBoard: function() {
		var arr = [];
		var _g = 0;
		while(_g < 81) {
			var i = _g++;
			arr.push(this.board[i]);
		}
		return arr;
	}
	,getHand: function() {
		return this.hand;
	}
	,getMoves: function() {
		return this.moves;
	}
	,SideToMove: function() {
		return this.sideToMove;
	}
	,setPosition: function(sfen) {
		sfen = StringTools.replace(sfen,"startpos","lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1");
		sfen = StringTools.replace(sfen,"sfen ","");
		haxe_Log.trace("SFEN::setPosition",{ fileName : "SFEN.hx", lineNumber : 45, className : "SFEN", methodName : "setPosition", customParams : [sfen]});
		var tokens = sfen.split(" ");
		var f = 8;
		var r = 0;
		var promote = false;
		var i = 0;
		var token = "";
		var sq = 0;
		this.board = [];
		haxe_Log.trace(tokens,{ fileName : "SFEN.hx", lineNumber : 54, className : "SFEN", methodName : "setPosition"});
		var _g = 0;
		var _g1 = tokens[0].length;
		while(_g < _g1) {
			var i1 = _g++;
			var token1 = tokens[0].charAt(i1);
			if(util_StringUtil.isNumberString(token1)) {
				var _g2 = 0;
				var _g11 = Std.parseInt(token1);
				while(_g2 < _g11) {
					var n = _g2++;
					sq = f * 9 + r;
					this.board[sq] = 0;
					--f;
				}
			} else if(token1 == "+") {
				promote = true;
			} else if(token1 == "/") {
				f = 8;
				++r;
			} else {
				sq = f * 9 + r;
				var pc = Types.getPieceFromLabel(token1);
				if(promote) {
					var this1 = pc + 8;
					pc = this1;
				}
				this.board[sq] = pc;
				--f;
				promote = false;
			}
		}
		this.sideToMove = tokens[1] == "b" ? 0 : 1;
		var ct = 0;
		var _g21 = 0;
		var _g3 = tokens[2].length;
		while(_g21 < _g3) {
			var i2 = _g21++;
			var token2 = tokens[2].charAt(i2);
			if(token2 == "-") {
				break;
			} else if(util_StringUtil.isNumberString(token2)) {
				ct = Std.parseInt(token2) + ct * 10;
			} else {
				ct = util_MathUtil.max(ct,1);
				var pc1 = Types.getPieceFromLabel(token2);
				this.hand[Types.getPieceColor(pc1)][Types.RawTypeOf(pc1)] = ct;
				ct = 0;
			}
		}
		if(sfen.indexOf("moves") > 0) {
			var mvs = sfen.split("moves ")[1].split(" ");
			var _g4 = 0;
			var _g5 = mvs.length;
			while(_g4 < _g5) {
				var i3 = _g4++;
				var m = Types.generateMoveFromString(mvs[i3]);
				this.moves.push(m);
			}
		}
	}
};
var Search = function() {
};
Search.__name__ = true;
Search.Init = function() {
	haxe_Log.trace("Search::Init",{ fileName : "Search.hx", lineNumber : 17, className : "Search", methodName : "Init"});
	var _g = 0;
	while(_g < 600) {
		var i = _g++;
		Search.rootMoves.push(new SearchRootMove());
	}
};
Search.Reset = function(pos) {
	haxe_Log.trace("Search::Reset",{ fileName : "Search.hx", lineNumber : 24, className : "Search", methodName : "Reset"});
	var _g = 0;
	while(_g < 600) {
		var i = _g++;
		Search.rootMoves[i].Clear();
	}
	Search.numRootMoves = 0;
	Search.rootPos = pos;
	var moves = new MoveList();
	moves.Generate(Search.rootPos,5);
	var _g1 = 0;
	var _g2 = moves.moveCount;
	while(_g1 < _g2) {
		var i1 = _g1++;
		Search.rootMoves[Search.numRootMoves].SetMove(moves.mlist[i1].move);
		Search.numRootMoves++;
	}
};
Search.Think = function() {
	haxe_Log.trace("Search::Think",{ fileName : "Search.hx", lineNumber : 39, className : "Search", methodName : "Think"});
	Search.maxPly = 0;
	Search.rootColor = Search.rootPos.SideToMove();
	Evaluate.evalRootColour = Search.rootColor;
	Search.IDLoop(Search.rootPos);
};
Search.IDLoop = function(pos) {
	haxe_Log.trace("====================",{ fileName : "Search.hx", lineNumber : 47, className : "Search", methodName : "IDLoop"});
	haxe_Log.trace("Search::IDLoop start",{ fileName : "Search.hx", lineNumber : 48, className : "Search", methodName : "IDLoop"});
	var depth = 0;
	var bestValue = -30001;
	var alpha = -30001;
	var beta = -30001;
	var delta = 30001;
	while(++depth <= 1) {
		var _g = 0;
		var _g1 = Search.pvSize;
		while(_g < _g1) {
			var pvIdx = _g++;
			while(true) {
				bestValue = Search.Search(pos,alpha,beta);
				Search.StableSort(Search.rootMoves,pvIdx,Search.numRootMoves - 1);
				if(bestValue <= alpha) {
					alpha = util_MathUtil.max(bestValue - delta,-30001);
				} else if(bestValue >= beta) {
					beta = util_MathUtil.min(bestValue + delta,30001);
				} else {
					break;
				}
				delta += delta / 2 | 0;
				break;
			}
			Search.StableSort(Search.rootMoves,0,util_MathUtil.min(Search.numRootMoves - 1,pvIdx + 1));
		}
	}
	haxe_Log.trace("Search::IDLoop end",{ fileName : "Search.hx", lineNumber : 74, className : "Search", methodName : "IDLoop"});
};
Search.StableSort = function(moves,begin,end) {
	if(begin == end) {
		return;
	}
	var swapped = false;
	var this1 = 0;
	var m = this1;
	var s = 0;
	var _g = begin;
	var _g1 = end;
	while(_g < _g1) {
		var j = _g++;
		swapped = false;
		var i = end;
		while(i > j) {
			if(moves[i - 1].score < moves[i].score) {
				swapped = true;
				var tmp = moves[i - 1];
				moves[i - 1] = moves[i];
				moves[i] = tmp;
				m = moves[i].pv[0];
				s = moves[i].score;
			}
			--i;
		}
		if(!swapped) {
			break;
		}
	}
};
Search.Qsearch = function(pos,alpha,beta,depth) {
	var bestValue = 0;
	bestValue = Evaluate.DoEvaluate(pos,false);
	haxe_Log.trace("Qsearch depth:" + depth + " alpha:" + alpha + " beta:" + beta + " value:" + bestValue,{ fileName : "Search.hx", lineNumber : 107, className : "Search", methodName : "Qsearch"});
	return bestValue;
};
Search.Search = function(pos,alpha,beta,depth) {
	if(depth == null) {
		depth = 0;
	}
	haxe_Log.trace("Search::Search",{ fileName : "Search.hx", lineNumber : 112, className : "Search", methodName : "Search"});
	var pvMove = true;
	var mp = new MovePicker();
	var this1 = 0;
	var move = this1;
	var rootNode = true;
	var value = 0;
	var $eval = 0;
	var st = new StateInfo();
	$eval = Evaluate.DoEvaluate(pos,false);
	mp.InitA(pos);
	while(true) {
		move = mp.NextMove();
		if(!(move != 0)) {
			break;
		}
		pos.doMove(move,st);
		value = -Search.Qsearch(pos,-alpha,-beta,depth);
		pos.undoMove(move);
		haxe_Log.trace("Search mvoe==" + Types.Move_To_String(move) + " color=" + pos.SideToMove() + " v=" + value + " alpha=" + alpha,{ fileName : "Search.hx", lineNumber : 129, className : "Search", methodName : "Search"});
		if(rootNode) {
			var rm;
			var _g = 0;
			var _g1 = Search.numRootMoves;
			while(_g < _g1) {
				var k = _g++;
				if(Search.rootMoves[k].Equals(move)) {
					rm = Search.rootMoves[k];
					if(pvMove || value > alpha) {
						rm.score = value;
					} else {
						rm.score = -30001;
					}
					break;
				}
			}
		}
		if(value > alpha) {
			haxe_Log.trace("Search value:" + value + " > alpha:" + alpha,{ fileName : "Search.hx", lineNumber : 145, className : "Search", methodName : "Search"});
			alpha = value;
		}
	}
	haxe_Log.trace("Search bestValue:" + alpha,{ fileName : "Search.hx", lineNumber : 153, className : "Search", methodName : "Search"});
	return alpha;
};
var SearchRootMove = function() {
	this.pv = [];
};
SearchRootMove.__name__ = true;
SearchRootMove.prototype = {
	Clear: function() {
		this.score = 0;
		this.prevScore = 0;
		this.pv[0] = 0;
		this.numMoves = 0;
	}
	,SetMove: function(m) {
		this.score = -30001;
		this.prevScore = -30001;
		this.pv[0] = m;
		this.numMoves = 1;
	}
	,Equals: function(m) {
		return this.pv[0] == m;
	}
};
var StateInfo = function() {
	this.materialValue = 0;
	this.capturedType = 0;
	this.checkersBB = new Bitboard();
};
StateInfo.__name__ = true;
StateInfo.prototype = {
	Clear: function() {
		this.checkersBB.Clear();
		var this1 = 0;
		this.capturedType = this1;
	}
	,Copy: function(other) {
		this.checkersBB.Copy(other.checkersBB);
		this.capturedType = other.capturedType;
		this.materialValue = other.materialValue;
		this.previous = other.previous;
	}
};
var Std = function() { };
Std.__name__ = true;
Std.string = function(s) {
	return js_Boot.__string_rec(s,"");
};
Std.parseInt = function(x) {
	var v = parseInt(x, x && x[0]=="0" && (x[1]=="x" || x[1]=="X") ? 16 : 10);
	if(isNaN(v)) {
		return null;
	}
	return v;
};
var StringTools = function() { };
StringTools.__name__ = true;
StringTools.replace = function(s,sub,by) {
	return s.split(sub).join(by);
};
var _$Types_Move_$Impl_$ = {};
_$Types_Move_$Impl_$.__name__ = true;
_$Types_Move_$Impl_$._new = function(i) {
	var this1 = i;
	return this1;
};
var _$Types_PR_$Impl_$ = {};
_$Types_PR_$Impl_$.__name__ = true;
_$Types_PR_$Impl_$._new = function(i) {
	var this1 = i;
	return this1;
};
var _$Types_PT_$Impl_$ = {};
_$Types_PT_$Impl_$.__name__ = true;
_$Types_PT_$Impl_$._new = function(i) {
	var this1 = i;
	return this1;
};
var _$Types_PC_$Impl_$ = {};
_$Types_PC_$Impl_$.__name__ = true;
_$Types_PC_$Impl_$._new = function(i) {
	var this1 = i;
	return this1;
};
var Types = function() { };
Types.__name__ = true;
Types.hasLongEffect = function(pt) {
	switch(pt) {
	case 5:
		return true;
	case 6:
		return true;
	case 13:
		return true;
	case 14:
		return true;
	default:
		return false;
	}
};
Types.OppColour = function(c) {
	return c ^ 1;
};
Types.Is_SqOK = function(s) {
	if(s >= 0) {
		return s <= 80;
	} else {
		return false;
	}
};
Types.File_Of = function(s) {
	return s / 9 | 0;
};
Types.Rank_Of = function(s) {
	return s % 9;
};
Types.FileString_Of = function(s) {
	return "" + (Types.File_Of(s) + 1);
};
Types.File_To_Char = function(f) {
	return "" + (f + 1);
};
Types.Rank_To_Char = function(r,toLower) {
	if(toLower == null) {
		toLower = true;
	}
	if(toLower) {
		var code = HxOverrides.cca("a",0) + r;
		return String.fromCodePoint(code);
	} else {
		var code1 = HxOverrides.cca("A",0) + r;
		return String.fromCodePoint(code1);
	}
};
Types.Square_To_String = function(s) {
	return Types.File_To_Char(Types.File_Of(s)) + Types.Rank_To_Char(Types.Rank_Of(s));
};
Types.Char_To_File = function(n) {
	return Std.parseInt(n) - 1;
};
Types.Char_To_Rank = function(a) {
	return HxOverrides.cca(a,0) - 97;
};
Types.Move_FromSq = function(m) {
	return m >>> 7 & 127;
};
Types.Move_ToSq = function(m) {
	return m & 127;
};
Types.Move_Dropped_Piece = function(m) {
	var this1 = m >>> 7 & 127;
	return this1;
};
Types.Move_Type = function(m) {
	return m & 49152;
};
Types.Move_To_String = function(m) {
	if(Types.Is_Drop(m)) {
		var this1 = Types.Move_Dropped_Piece(m);
		var pc = Types.PieceToChar(this1);
		var str = Types.Square_To_String(Types.Move_ToSq(m));
		return "" + pc + "*" + str;
	} else if(Types.Is_Promote(m)) {
		return Types.Square_To_String(Types.Move_FromSq(m)) + Types.Square_To_String(Types.Move_ToSq(m)) + "+";
	} else {
		return Types.Square_To_String(Types.Move_FromSq(m)) + Types.Square_To_String(Types.Move_ToSq(m));
	}
};
Types.Move_To_StringLong = function(m) {
	return Types.Move_To_String(m) + " " + Types.Move_Type_String(m) + " : " + m;
};
Types.Move_Type_String = function(m) {
	if(Types.Move_Type(m) == 16384) {
		return "Drop";
	}
	if(Types.Move_Type(m) == 32768) {
		return "Promo";
	}
	return "Normal";
};
Types.Make_Move = function(from,to) {
	var this1 = to | from << 7;
	return this1;
};
Types.Make_Move_Promote = function(from,to) {
	var this1 = to | from << 7 | 32768;
	return this1;
};
Types.Make_Move_Drop = function(pr,sq) {
	var this1 = sq | pr << 7 | 16384;
	return this1;
};
Types.generateMoveFromString = function(ft) {
	var f = Types.Char_To_File(ft.charAt(0));
	var r = Types.Char_To_Rank(ft.charAt(1));
	var from = Types.Square(f,r);
	f = Types.Char_To_File(ft.charAt(2));
	r = Types.Char_To_Rank(ft.charAt(3));
	var to = Types.Square(f,r);
	if(ft.indexOf("*") > 0) {
		var pr = Types.RawTypeOf(Types.getPieceFromLabel(ft.charAt(0)));
		f = Types.Char_To_File(ft.charAt(2));
		r = Types.Char_To_Rank(ft.charAt(3));
		to = Types.Square(f,r);
		return Types.Make_Move_Drop(pr,to);
	} else if(ft.indexOf("+") > 0) {
		return Types.Make_Move_Promote(from,to);
	} else {
		return Types.Make_Move(from,to);
	}
};
Types.Is_Move_OK = function(m) {
	return Types.Move_FromSq(m) != Types.Move_ToSq(m);
};
Types.Is_Promote = function(m) {
	return (m & 32768) != 0;
};
Types.Is_Drop = function(m) {
	return (m & 16384) != 0;
};
Types.RankString_Of = function(s) {
	var code = 97 + Types.Rank_Of(s);
	return String.fromCodePoint(code);
};
Types.RawTypeOf = function(p) {
	var this1 = p % 8;
	return this1;
};
Types.Make_Piece = function(c,pt) {
	var this1 = c << 4 | pt;
	return this1;
};
Types.Square = function(f,r) {
	return f * 9 + r;
};
Types.FlipSquare = function(sq) {
	return Types.flipSquare[sq];
};
Types.getPieceColor = function(pc) {
	if(pc == 0) {
		return -1;
	}
	if((pc | 0) < 16) {
		return 0;
	} else {
		return 1;
	}
};
Types.TypeOf_Piece = function(pc) {
	var this1 = pc % 16;
	return this1;
};
Types.PieceToChar = function(pc) {
	if(pc == 1) {
		return "P";
	}
	if(pc == 2) {
		return "L";
	}
	if(pc == 4) {
		return "S";
	}
	if(pc == 3) {
		return "N";
	}
	if(pc == 5) {
		return "B";
	}
	if(pc == 6) {
		return "R";
	}
	if(pc == 7) {
		return "G";
	}
	if(pc == 8) {
		return "K";
	}
	if(pc == 9) {
		return "+P";
	}
	if(pc == 10) {
		return "+L";
	}
	if(pc == 11) {
		return "+N";
	}
	if(pc == 12) {
		return "+S";
	}
	if(pc == 13) {
		return "+B";
	}
	if(pc == 14) {
		return "+R";
	}
	if(pc == 17) {
		return "p";
	}
	if(pc == 18) {
		return "l";
	}
	if(pc == 19) {
		return "n";
	}
	if(pc == 20) {
		return "s";
	}
	if(pc == 21) {
		return "b";
	}
	if(pc == 22) {
		return "r";
	}
	if(pc == 23) {
		return "g";
	}
	if(pc == 24) {
		return "k";
	}
	if(pc == 25) {
		return "+p";
	}
	if(pc == 26) {
		return "+l";
	}
	if(pc == 27) {
		return "+n";
	}
	if(pc == 28) {
		return "+s";
	}
	if(pc == 29) {
		return "+b";
	}
	if(pc == 30) {
		return "+r";
	}
	return "?";
};
Types.getPieceFromLabel = function(token) {
	switch(token) {
	case "B":
		return 5;
	case "G":
		return 7;
	case "K":
		return 8;
	case "L":
		return 2;
	case "N":
		return 3;
	case "P":
		return 1;
	case "R":
		return 6;
	case "S":
		return 4;
	case "b":
		return 21;
	case "g":
		return 23;
	case "k":
		return 24;
	case "l":
		return 18;
	case "n":
		return 19;
	case "p":
		return 17;
	case "r":
		return 22;
	case "s":
		return 20;
	default:
		return 0;
	}
};
Types.getPieceLabel = function(pt) {
	switch((pt | 0) % 16) {
	case 0:
		return "";
	case 1:
		return "";
	case 2:
		return "";
	case 3:
		return "";
	case 4:
		return "";
	case 5:
		return "";
	case 6:
		return "";
	case 7:
		return "";
	case 8:
		return "";
	case 9:
		return "";
	case 10:
		return "";
	case 11:
		return "";
	case 12:
		return "";
	case 13:
		return "";
	case 14:
		return "";
	default:
		return "";
	}
};
var haxe_Log = function() { };
haxe_Log.__name__ = true;
haxe_Log.formatOutput = function(v,infos) {
	var str = Std.string(v);
	if(infos == null) {
		return str;
	}
	var pstr = infos.fileName + ":" + infos.lineNumber;
	if(infos.customParams != null) {
		var _g = 0;
		var _g1 = infos.customParams;
		while(_g < _g1.length) {
			var v1 = _g1[_g];
			++_g;
			str += ", " + Std.string(v1);
		}
	}
	return pstr + ": " + str;
};
haxe_Log.trace = function(v,infos) {
	var str = haxe_Log.formatOutput(v,infos);
	if(typeof(console) != "undefined" && console.log != null) {
		console.log(str);
	}
};
var js__$Boot_HaxeError = function(val) {
	Error.call(this);
	this.val = val;
	if(Error.captureStackTrace) {
		Error.captureStackTrace(this,js__$Boot_HaxeError);
	}
};
js__$Boot_HaxeError.__name__ = true;
js__$Boot_HaxeError.__super__ = Error;
js__$Boot_HaxeError.prototype = $extend(Error.prototype,{
});
var js_Boot = function() { };
js_Boot.__name__ = true;
js_Boot.__string_rec = function(o,s) {
	if(o == null) {
		return "null";
	}
	if(s.length >= 5) {
		return "<...>";
	}
	var t = typeof(o);
	if(t == "function" && (o.__name__ || o.__ename__)) {
		t = "object";
	}
	switch(t) {
	case "function":
		return "<function>";
	case "object":
		if(((o) instanceof Array)) {
			var str = "[";
			s += "\t";
			var _g3 = 0;
			var _g11 = o.length;
			while(_g3 < _g11) {
				var i = _g3++;
				str += (i > 0 ? "," : "") + js_Boot.__string_rec(o[i],s);
			}
			str += "]";
			return str;
		}
		var tostr;
		try {
			tostr = o.toString;
		} catch( e1 ) {
			var e2 = ((e1) instanceof js__$Boot_HaxeError) ? e1.val : e1;
			return "???";
		}
		if(tostr != null && tostr != Object.toString && typeof(tostr) == "function") {
			var s2 = o.toString();
			if(s2 != "[object Object]") {
				return s2;
			}
		}
		var str1 = "{\n";
		s += "\t";
		var hasp = o.hasOwnProperty != null;
		var k = null;
		for( k in o ) {
		if(hasp && !o.hasOwnProperty(k)) {
			continue;
		}
		if(k == "prototype" || k == "__class__" || k == "__super__" || k == "__interfaces__" || k == "__properties__") {
			continue;
		}
		if(str1.length != 2) {
			str1 += ", \n";
		}
		str1 += s + k + " : " + js_Boot.__string_rec(o[k],s);
		}
		s = s.substring(1);
		str1 += "\n" + s + "}";
		return str1;
	case "string":
		return o;
	default:
		return String(o);
	}
};
var util_MathUtil = function() { };
util_MathUtil.__name__ = true;
util_MathUtil.abs = function(a) {
	if(a >= 0) {
		return a;
	} else {
		return -a;
	}
};
util_MathUtil.max = function(a,b) {
	if(a > b) {
		return a;
	} else {
		return b;
	}
};
util_MathUtil.min = function(a,b) {
	if(a < b) {
		return a;
	} else {
		return b;
	}
};
var util_StringUtil = function() { };
util_StringUtil.__name__ = true;
util_StringUtil.isNumberString = function(s) {
	var r = new EReg("[0-9]+","");
	return r.match(s);
};
if( String.fromCodePoint == null ) String.fromCodePoint = function(c) { return c < 0x10000 ? String.fromCharCode(c) : String.fromCharCode((c>>10)+0xD7C0)+String.fromCharCode((c&0x3FF)+0xDC00); }
String.__name__ = true;
Array.__name__ = true;
Object.defineProperty(js__$Boot_HaxeError.prototype,"message",{ get : function() {
	return String(this.val);
}});
js_Boot.__toStr = ({ }).toString;
BB.squareDistance = [];
BB.stepAttacksBB = [];
BB.betweenBB = [];
BB.lineBB = [];
BB.squareBB = [];
BB.enemyField1 = [];
BB.enemyField2 = [];
BB.enemyField3 = [];
BB.pawnLineBB = [];
BB.pseudoAttacks = [];
BB.pseudoQueenAttacks = [];
BB.initialized = false;
BB.steps = [[0,0,0,0,0,0,0,0,0],[-1,0,0,0,0,0,0,0,0],[-1,-2,-3,-4,-5,-6,-7,-8,0],[7,-11,0,0,0,0,0,0,0],[-1,8,10,-10,-8,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[-1,8,9,1,-10,-9,0,0,0],[-1,8,9,1,-10,-9,10,-8,0],[-1,8,9,1,-10,-9,0,0,0],[-1,8,9,1,-10,-9,0,0,0],[-1,8,9,1,-10,-9,0,0,0],[-1,8,9,1,-10,-9,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];
BB.rDeltas = [-1,-9,1,9];
BB.bDeltas = [-10,-8,10,8];
Bitboard.NA = 27;
Bitboard.NB = 54;
Engine.global = eval("self");
Evaluate.evalRootColour = 0;
Evaluate.pieceValue = [0,90,315,405,495,855,990,540,15000,540,540,540,540,945,1395,0,0,-90,-315,-405,-495,-855,-990,-540,-15000,-540,-540,-540,-540,-945,-1395];
Evaluate.capturePieceValue = [0,180,630,810,990,1710,1980,1080,15000,630,855,945,1035,1800,2385,0,0,180,630,810,990,1710,1980,1080,15000,630,855,945,1035,1800,2385];
Evaluate.proDiffPieceValue = [0,450,225,135,45,90,405,0,0];
MoveList.CAPTURES = 0;
MoveList.QUIETS = 1;
MoveList.QUIET_CHECKS = 2;
MoveList.EVASIONS = 3;
MoveList.NON_EVASIONS = 4;
MoveList.LEGAL = 5;
MovePicker.MAIN_SEARCH = 0;
MovePicker.CAPTURES_S1 = 1;
MovePicker.KILLERS_S1 = 2;
MovePicker.QUIETS_1_S1 = 3;
MovePicker.QUIETS_2_S1 = 4;
MovePicker.BAD_CAPTURES_S1 = 5;
MovePicker.EVASION = 6;
MovePicker.EVASIONS_S2 = 7;
MovePicker.QSEARCH_0 = 8;
MovePicker.CAPTURES_S3 = 9;
MovePicker.QUIET_CHECKS_S3 = 10;
MovePicker.QSEARCH_1 = 11;
MovePicker.CAPTURES_S4 = 12;
MovePicker.PROBCUT = 13;
MovePicker.CAPTURES_S5 = 14;
MovePicker.RECAPTURE = 15;
MovePicker.CAPTURES_S6 = 16;
MovePicker.STOP = 17;
PSQTable.psqT = [[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];
Position.psq = [];
Position.pieceValue = [0,90,315,405,495,855,990,540,15000,540,540,540,540,945,1395];
SFEN.startpos = "lnsgkgsnl/1r5b1/ppppppppp/9/9/9/PPPPPPPPP/1B5R1/LNSGKGSNL b - 1";
Search.rootMoves = [];
Search.numRootMoves = 0;
Search.rootColor = 0;
Search.maxPly = 0;
Search.pvSize = 1;
Types.BLACK = 0;
Types.WHITE = 1;
Types.FILE_A = 0;
Types.RANK_1 = 0;
Types.COLOR_NB = 2;
Types.ALL_PIECES = 0;
Types.PIECE_TYPE_NB = 15;
Types.PIECE_PROMOTE = 8;
Types.PIECE_HAND_NB = 8;
Types.NO_PIECE_TYPE = 0;
Types.PAWN = 1;
Types.LANCE = 2;
Types.KNIGHT = 3;
Types.SILVER = 4;
Types.BISHOP = 5;
Types.ROOK = 6;
Types.GOLD = 7;
Types.KING = 8;
Types.PRO_PAWN = 9;
Types.PRO_LANCE = 10;
Types.PRO_KNIGHT = 11;
Types.PRO_SILVER = 12;
Types.HORSE = 13;
Types.DRAGON = 14;
Types.NO_PIECE = 0;
Types.B_PAWN = 1;
Types.B_LANCE = 2;
Types.B_KNIGHT = 3;
Types.B_SILVER = 4;
Types.B_BISHOP = 5;
Types.B_ROOK = 6;
Types.B_GOLD = 7;
Types.B_KING = 8;
Types.B_PRO_PAWN = 9;
Types.B_PRO_LANCE = 10;
Types.B_PRO_KNIGHT = 11;
Types.B_PRO_SILVER = 12;
Types.B_HORSE = 13;
Types.B_DRAGON = 14;
Types.W_PAWN = 17;
Types.W_LANCE = 18;
Types.W_KNIGHT = 19;
Types.W_SILVER = 20;
Types.W_BISHOP = 21;
Types.W_ROOK = 22;
Types.W_GOLD = 23;
Types.W_KING = 24;
Types.W_PRO_PAWN = 25;
Types.W_PRO_LANCE = 26;
Types.W_PRO_KNIGHT = 27;
Types.W_PRO_SILVER = 28;
Types.W_HORSE = 29;
Types.W_DRAGON = 30;
Types.PIECE_NB = 31;
Types.SQ_A1 = 0;
Types.SQ_HB = 80;
Types.SQ_NB = 81;
Types.SQ_NONE = 81;
Types.FILE_NB = 9;
Types.RANK_NB = 9;
Types.MAX_MOVES = 600;
Types.MAX_PLY = 1;
Types.DELTA_N = -1;
Types.DELTA_E = -9;
Types.DELTA_S = 1;
Types.DELTA_W = 9;
Types.DELTA_NN = -2;
Types.DELTA_NE = -10;
Types.DELTA_SE = -8;
Types.DELTA_SS = 2;
Types.DELTA_SW = 10;
Types.DELTA_NW = 8;
Types.MOVE_NONE = 0;
Types.MOVE_NORMAL = 0;
Types.MOVE_DROP = 16384;
Types.MOVE_PROMO = 32768;
Types.VALUE_ZERO = 0;
Types.VALUE_DRAW = 0;
Types.VALUE_KNOWN_WIN = 15000;
Types.VALUE_MATE = 30000;
Types.VALUE_INFINITE = 30001;
Types.VALUE_NONE = 30002;
Types.PawnValue = 90;
Types.LanceValue = 315;
Types.KnightValue = 405;
Types.SilverValue = 495;
Types.GoldValue = 540;
Types.BishopValue = 855;
Types.RookValue = 990;
Types.ProPawnValue = 540;
Types.ProLanceValue = 540;
Types.ProKnightValue = 540;
Types.ProSilverValue = 540;
Types.HorseValue = 945;
Types.DragonValue = 1395;
Types.KingValue = 15000;
Types.flipSquare = [80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,64,63,62,61,60,59,58,57,56,55,54,53,52,51,50,49,48,47,46,45,44,43,42,41,40,39,38,37,36,35,34,33,32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0];
Engine.main();
})({});
